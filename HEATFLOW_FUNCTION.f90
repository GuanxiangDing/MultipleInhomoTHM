  
    
FUNCTION QFLOW_I(StrN,Num,X,Z)
INTEGER StrN,Num
DOUBLE PRECISION QFLOW_I,X,Z
DOUBLE PRECISION U1,U3,Y2
DOUBLE PRECISION T11,T12,T21,T22

!20221129 I MODIFY
U1=DATAN(X/Z)
U3=DATAN(Z/X)
Y2=-0.5D0*DLOG(X*X+Z*Z)

!20231111 IMAGE
!U1=DATAN(Z/X)
!U3=DATAN(X/Z)

T11=U1
T12=Y2

T21=Y2
T22=U3

IF(StrN==1.AND.Num==1) GOTO 11
IF(StrN==1.AND.Num==2) GOTO 12

IF(StrN==2.AND.Num==1) GOTO 21
IF(StrN==2.AND.Num==2) GOTO 22


11  QFLOW_I = T11
    RETURN
12  QFLOW_I = T12
    RETURN
21  QFLOW_I = T21
    RETURN
22  QFLOW_I = T22
    RETURN

END